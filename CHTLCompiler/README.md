# CHTL编译器

基于C++17实现的CHTL（基于C++语言实现的超文本语言）编译器，支持将CHTL源代码编译为HTML、CSS和JavaScript。

## 项目架构

```
┌─────────────────────────────────────────────────────────────────┐
│                         CHTL源代码                               │
└─────────────────────────────┬───────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                    CHTLUnifiedScanner                           │
│                   (精准代码切割器)                               │
└─────────────────────────────┬───────────────────────────────────┘
                              │
                              ▼
        ┌──────────────┬──────────────┬──────────────┬────────────┐
        │   CHTL片段   │ CHTL JS片段  │   CSS片段    │   JS片段   │
        └──────┬───────┴──────┬───────┴──────┬───────┴──────┬─────┘
               │              │              │              │
               ▼              ▼              ▼              ▼
┌─────────────────────────────────────────────────────────────────┐
│                    CompilerDispatcher                           │
│                   (编译器调度器)                                 │
└──────┬──────────────┬──────────────┬──────────────┬────────────┘
       │              │              │              │
       ▼              ▼              ▼              ▼
┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐
│    CHTL     │ │   CHTL JS   │ │     CSS     │ │JavaScript   │
│  Compiler   │ │  Compiler   │ │  Compiler   │ │  Compiler   │
│  (手写)     │ │  (手写)     │ │  (ANTLR)    │ │  (ANTLR)    │
└─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘
       │              │              │              │
       └──────────────┴──────────────┴──────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                      编译结果合并                                │
│                     (HTML输出)                                   │
└─────────────────────────────────────────────────────────────────┘
```

## 特性

- **CHTL编译器（手写）**: 支持CHTL的所有语法特性，包括局部样式块、模板、自定义等
- **CHTL JS编译器（手写）**: 支持CHTL JS扩展语法，包括增强选择器、事件监听器等
- **CSS编译器（ANTLR）**: 基于ANTLR4的CSS解析和编译
- **JavaScript编译器（ANTLR）**: 基于ANTLR4的JavaScript解析和编译
- **统一扫描器**: 智能识别和切割不同类型的代码片段
- **编译器调度器**: 协调各个编译器，统一管理编译流程

## 编译要求

- C++17或更高版本
- CMake 3.16或更高版本
- ANTLR4运行时库

## 构建步骤

1. 克隆项目
```bash
git clone <repository-url>
cd CHTLCompiler
```

2. 创建构建目录
```bash
mkdir build
cd build
```

3. 配置CMake
```bash
cmake ..
```

4. 编译项目
```bash
make
```

## 使用方法

### 基本用法

```bash
# 编译CHTL文件
./chtl_compiler input.chtl

# 指定输出文件
./chtl_compiler input.chtl -o output.html

# 启用调试模式
./chtl_compiler input.chtl -d

# 压缩输出
./chtl_compiler input.chtl -m

# 格式化输出
./chtl_compiler input.chtl -f
```

### 命令行选项

- `-h, --help`: 显示帮助信息
- `-v, --version`: 显示版本信息
- `-o <文件>`: 指定输出文件
- `-d, --debug`: 启用调试模式
- `-m, --minify`: 压缩输出
- `-f, --format`: 格式化输出

## 测试

项目包含一个测试用的CHTL文件 `test.chtl`，可以用来验证编译器的功能：

```bash
./chtl_compiler test.chtl -d
```

## 项目结构

```
CHTLCompiler/
├── include/                 # 头文件
│   ├── scanner/            # 扫描器相关头文件
│   ├── compiler/           # 编译器相关头文件
│   ├── dispatcher/         # 调度器相关头文件
│   └── utils/              # 工具类头文件
├── src/                    # 源代码
│   ├── scanner/            # 扫描器实现
│   ├── compiler/           # 编译器实现
│   ├── dispatcher/         # 调度器实现
│   ├── utils/              # 工具类实现
│   └── main.cpp            # 主程序
├── test/                   # 测试文件
├── third_party/            # 第三方库
├── scripts/                # 构建脚本
├── CMakeLists.txt          # CMake配置
├── test.chtl               # 测试CHTL文件
└── README.md               # 项目说明
```

## 支持的CHTL语法

### 基本语法
- 注释：`//` 和 `/**/`
- 文本节点：`text { }`
- 元素节点：HTML所有元素
- 属性：`属性名: "属性值";`

### 局部样式块
- 内联样式
- 自动化类名/ID
- 上下文推导

### 模板系统
- 样式组模板：`[Template] @Style`
- 元素模板：`[Template] @Element`
- 变量组模板：`[Template] @Var`
- 继承和特例化

### CHTL JS扩展
- 局部script块
- 增强选择器：`{{选择器}}`
- 增强监听器：`listen()`
- 事件委托：`delegate()`
- 动画：`animate()`

## 贡献

欢迎提交Issue和Pull Request来改进这个项目。

## 许可证

本项目采用MIT许可证。

## 联系方式

如有问题或建议，请通过以下方式联系：
- 提交GitHub Issue
- 发送邮件至项目维护者

---

**注意**: 这是一个演示项目，某些功能可能尚未完全实现。在实际使用中，建议根据具体需求进行完善和优化。